
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>rai_toolbox.augmentations.augmix.AugMix &#8212; rai-toolbox  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="rai_toolbox.augmentations.augmix.Fork" href="rai_toolbox.augmentations.augmix.Fork.html" />
    <link rel="prev" title="rai_toolbox.augmentations.fourier.create_heatmaps" href="rai_toolbox.augmentations.fourier.create_heatmaps.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    
      
      <link rel="icon" sizes="16x16" href="../_static/favicon-16x16.png">
      
    
      
      <link rel="icon" sizes="32x32" href="../_static/favicon-32x32.png">
      
    
      
      <link rel="apple-touch-icon" sizes="180x180" href="../_static/apple-touch-icon.png">
      
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/logo_no_text.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../how_tos.html">
  How-To Guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../explanation.html">
  Explanation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api_reference.html">
  Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../changes.html">
  Changelog
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/mit-ll-responsible-ai/responsible-ai-toolbox/" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_optim.html">
   Optimizers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_perturbation.html">
   Perturbations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_datasets.html">
   Datasets
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../ref_augmentations.html">
   Augmentations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.fourier.FourierBasis.html">
     rai_toolbox.augmentations.fourier.FourierBasis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.fourier.generate_fourier_bases.html">
     rai_toolbox.augmentations.fourier.generate_fourier_bases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.fourier.create_heatmaps.html">
     rai_toolbox.augmentations.fourier.create_heatmaps
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     rai_toolbox.augmentations.augmix.AugMix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.augmix.Fork.html">
     rai_toolbox.augmentations.augmix.Fork
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.augmix.augment_and_mix.html">
     rai_toolbox.augmentations.augmix.augment_and_mix
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_losses.html">
   Losses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_mushin.html">
   Mushin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_utils.html">
   General Utilities
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="rai-toolbox-augmentations-augmix-augmix">
<h1>rai_toolbox.augmentations.augmix.AugMix<a class="headerlink" href="#rai-toolbox-augmentations-augmix-augmix" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="rai_toolbox.augmentations.augmix.AugMix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">rai_toolbox.augmentations.augmix.</span></span><span class="sig-name descname"><span class="pre">AugMix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentations</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_aug_chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aug_chain_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirichlet_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation_choice_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rai_toolbox/augmentations/augmix/transforms.html#AugMix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rai_toolbox.augmentations.augmix.AugMix" title="Permalink to this definition">#</a></dt>
<dd><p>Augments <code class="xref py py-obj docutils literal notranslate"><span class="pre">datum</span></code> using a mixture of randomly-composed augmentations via a method
called “AugMix” <a class="reference internal" href="#rd2eef4740ea0-1" id="id1">[1]</a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>datum</strong><span class="classifier">T1</span></dt><dd><p>The datum to be augmixed.</p>
</dd>
<dt><strong>num_aug_chains</strong><span class="classifier">int</span></dt><dd><p>The number of independent “augmentation chains” that are used to produce the augmixed
result.</p>
</dd>
<dt><strong>aug_chain_depth</strong><span class="classifier">Union[int, Tuple[int, int]]</span></dt><dd><p>Determines that number of augmentations that are randomly sampled (with replacement) and
composed to form each augmentation chain.</p>
<p>If a tuple of values are provided, these are used as the lower (inclusive) and
upper (exclusive) bounds on a uniform integer-valued distribution from which the depth
will be sampled for each augmentation chain.</p>
<p>E.g.,</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">mixture_depth=2</span></code> means that each augmentation chain will consist of two (randomly sampled) augmentations composed together.</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">aug_chain_depth=(1,</span> <span class="pre">4)</span></code> means depth of any given augmentation chain is uniformly sampled from [1, 4).</p></li>
</ul>
</dd>
<dt><strong>process_fn</strong><span class="classifier">Callable[[T1], T2]</span></dt><dd><p>The preprocessing function applied to the both clean and augmixed datums before
they are combined. The return type of <code class="xref py py-obj docutils literal notranslate"><span class="pre">process_fn</span></code> determines the return type
of <a class="reference internal" href="rai_toolbox.augmentations.augmix.augment_and_mix.html#rai_toolbox.augmentations.augmix.augment_and_mix" title="rai_toolbox.augmentations.augmix.augment_and_mix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">augment_and_mix</span></code></a>.</p>
</dd>
<dt><strong>augmentations</strong><span class="classifier">Sequence[Callable[[T1], T1]]</span></dt><dd><p>The collection of datum augmentations that is sampled from (with replacement) to form each augmentation
chain.</p>
</dd>
<dt><strong>beta_params</strong><span class="classifier">Tuple[float, float]</span></dt><dd><p>The Beta distribution parameters to draw <code class="xref py py-obj docutils literal notranslate"><span class="pre">m</span></code>, which weights that convex combination:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="n">img_process_fn</span><span class="p">(</span><span class="n">datum</span><span class="p">)</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">img_process_fn</span><span class="p">(</span><span class="n">augment</span><span class="p">(</span><span class="n">datum</span><span class="p">))</span>
</pre></div>
</div>
<p>If a single value is specified, it is used as both parameters for the distribution.</p>
</dd>
<dt><strong>dirichlet_params</strong><span class="classifier">Union[float, Sequence[float]]</span></dt><dd><p>The Dirichlet distribution parameters used to weight the <code class="xref py py-obj docutils literal notranslate"><span class="pre">mixture_width</span></code> number of augmentation chains.
If a sequence is provided, its length must match <code class="xref py py-obj docutils literal notranslate"><span class="pre">num_aug_chains</span></code>.</p>
</dd>
<dt><strong>augmentation_choice_probs</strong><span class="classifier">Optional[Sequence[float]]</span></dt><dd><p>The probabilities associated with sampling each respective entry in <code class="xref py py-obj docutils literal notranslate"><span class="pre">augmentations</span></code>.
If not specified, a uniform distribution over all entries of <code class="xref py py-obj docutils literal notranslate"><span class="pre">augmentation</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>augmixed: T2</dt><dd><p>The augmixed datum.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The following depicts AugMix with N augmentation chains. Each <code class="xref py py-obj docutils literal notranslate"><span class="pre">augchain(...)</span></code> consists of
composed augmentations, where the composition depth is determined by <code class="xref py py-obj docutils literal notranslate"><span class="pre">mixture_depth</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>(1 - m) * process_fn(img) + m * (w1 * (process_fn ∘ augchain1)(img) + ... + wN * (process_fn ∘ augchainN)(img))
</pre></div>
</div>
<p>with</p>
<ul class="simple">
<li><p>m ~ Beta</p></li>
<li><p>[w1, …, wN] ~ Dirichlet</p></li>
</ul>
<p>Random values are drawn via NumPy’s global random number generator. Thus <a class="reference external" href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.seed.html#numpy.random.seed" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.random.seed</span></code></a>
must be set in order to obtain reproducible results. Note that, until
PyTorch 1.9.0, there was an issue with using NumPy’s global RNG in conjunction with
DataLoaders that used multiple workers, where identical seeds were being used
across workers and the same seed was being set at the outset of each epoch.</p>
<p><a class="reference external" href="https://github.com/pytorch/pytorch/pull/56488">https://github.com/pytorch/pytorch/pull/56488</a></p>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rd2eef4740ea0-1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Hendrycks, Dan, et al. “Augmix: A simple data processing method to improve robustness and uncertainty.” arXiv preprint arXiv:1912.02781 (2019).</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rai_toolbox.augmentations.augmix.AugMix.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">process_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentations</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_aug_chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">aug_chain_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,</span> <span class="pre">4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">1.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirichlet_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">augmentation_choice_probs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rai_toolbox/augmentations/augmix/transforms.html#AugMix.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rai_toolbox.augmentations.augmix.AugMix.__init__" title="Permalink to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable table autosummary">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#rai_toolbox.augmentations.augmix.AugMix.__init__" title="rai_toolbox.augmentations.augmix.AugMix.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(process_fn, augmentations, *[, ...])</p></td>
<td><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="rai_toolbox.augmentations.fourier.create_heatmaps.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">rai_toolbox.augmentations.fourier.create_heatmaps</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="rai_toolbox.augmentations.augmix.Fork.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">rai_toolbox.augmentations.augmix.Fork</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022 Massachusetts Institute of Technology.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>