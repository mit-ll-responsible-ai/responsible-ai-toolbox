
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>rai_toolbox.augmentations.fourier.generate_fourier_bases &#8212; rai-toolbox  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="rai_toolbox.augmentations.fourier.create_heatmaps" href="rai_toolbox.augmentations.fourier.create_heatmaps.html" />
    <link rel="prev" title="rai_toolbox.augmentations.fourier.FourierBasis" href="rai_toolbox.augmentations.fourier.FourierBasis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">rai-toolbox</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../tutorials.html">
  Tutorials
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../how_tos.html">
  How-To Guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../explanation.html">
  Explanation
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../api_reference.html">
  Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../changes.html">
  Changelog
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/mit-ll-responsible-ai/responsible-ai-toolbox" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contents:
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_optim.html">
   Optimizers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_perturbation.html">
   Perturbations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_datasets.html">
   Datasets
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../ref_augmentations.html">
   Augmentations
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.fourier.FourierBasis.html">
     rai_toolbox.augmentations.fourier.FourierBasis
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     rai_toolbox.augmentations.fourier.generate_fourier_bases
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.fourier.create_heatmaps.html">
     rai_toolbox.augmentations.fourier.create_heatmaps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.augmix.AugMix.html">
     rai_toolbox.augmentations.augmix.AugMix
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.augmix.Fork.html">
     rai_toolbox.augmentations.augmix.Fork
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="rai_toolbox.augmentations.augmix.augment_and_mix.html">
     rai_toolbox.augmentations.augmix.augment_and_mix
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_losses.html">
   Losses
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../ref_mushin.html">
   Mushin
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="rai_toolbox.evaluating.html">
   rai_toolbox.evaluating
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rai_toolbox.freeze.html">
   rai_toolbox.freeze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rai_toolbox.frozen.html">
   rai_toolbox.frozen
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="rai_toolbox.negate.html">
   rai_toolbox.negate
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    
</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="rai-toolbox-augmentations-fourier-generate-fourier-bases">
<h1>rai_toolbox.augmentations.fourier.generate_fourier_bases<a class="headerlink" href="#rai-toolbox-augmentations-fourier-generate-fourier-bases" title="Permalink to this headline">#</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="rai_toolbox.augmentations.fourier.generate_fourier_bases">
<span class="sig-prename descclassname"><span class="pre">rai_toolbox.augmentations.fourier.</span></span><span class="sig-name descname"><span class="pre">generate_fourier_bases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nrows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor_2pi_phase_shift=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_col_coords=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rai_toolbox/augmentations/fourier/_fourier_basis.html#generate_fourier_bases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rai_toolbox.augmentations.fourier.generate_fourier_bases" title="Permalink to this definition">#</a></dt>
<dd><p>Yields each unique, real-valued 2D array with unit norm, such that its Fourier
transform is supported at each (i, j) and its symmetric position on a shape-(nrows, ncols)
grid in Fourier space, where the lowest frequency component resides at the center of
the grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nrows</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>ncols</strong><span class="classifier">int</span></dt><dd></dd>
<dt><strong>dtype</strong><span class="classifier">DTypeLike</span></dt><dd></dd>
<dt><strong>factor_2pi_phase_shift</strong><span class="classifier">float (optional, default=0)</span></dt><dd><p>E.g. specifying <code class="docutils literal notranslate"><span class="pre">0.5</span></code> will induce a phase-shift of pi on all bases.</p>
</dd>
<dt><strong>row_col_coords</strong><span class="classifier">Optional[Iterable[Tuple[int, int]]]</span></dt><dd><p>If provided, specifies the specific Fourier-bases to generate in terms of their
Fourier-space locations. Otherwise, all non-redundant entries on the nrows x ncols
grip will be generated.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Yields</dt>
<dd class="field-even"><dl class="simple">
<dt>fourier_basis: FourierBasis</dt><dd><p>Yields the array’s position in Fourier space, (k_row, k_col), its symmetric position, and the
shape-(nrows, ncols) real-valued basis array itself.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The iteration is performed in row-major order in 2D Fourier space, starting with the position (0, 0).</p>
<p class="rubric">Examples</p>
<p>Here we will visualize the collection of bases in Fourier space that support the</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ll_freq_analysis</span> <span class="kn">import</span> <span class="n">generate_fourier_bases</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">basis</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">generate_fourier_bases</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="go">[array([[ 0.33,  0.12, -0.46],</span>
<span class="go">    [ 0.12, -0.46,  0.33],</span>
<span class="go">    [-0.46,  0.33,  0.12]]),</span>
<span class="go">array([[ 0.33,  0.33,  0.33],</span>
<span class="go">        [ 0.12,  0.12,  0.12],</span>
<span class="go">        [-0.46, -0.46, -0.46]]),</span>
<span class="go">array([[ 0.33, -0.46,  0.12],</span>
<span class="go">        [ 0.12,  0.33, -0.46],</span>
<span class="go">        [-0.46,  0.12,  0.33]]),</span>
<span class="go">array([[ 0.33,  0.12, -0.46],</span>
<span class="go">        [ 0.33,  0.12, -0.46],</span>
<span class="go">        [ 0.33,  0.12, -0.46]]),</span>
<span class="go">array([[0.33, 0.33, 0.33],</span>
<span class="go">        [0.33, 0.33, 0.33],</span>
<span class="go">        [0.33, 0.33, 0.33]])]</span>
</pre></div>
</div>
<p>We’ll now inspect the corresponding support arrays in Fourier space.
Note that only five basis arrays, not nine, are returned in association with the
specified 3x3 grid. This is because the remaining four bases are redundant due
to the symmetries in the support space.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">x</span><span class="p">))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">basis</span><span class="p">)</span> <span class="k">for</span> <span class="n">out</span> <span class="ow">in</span> <span class="n">generate_fourier_bases</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="go">[array([[2., 0., 0.],</span>
<span class="go">        [0., 0., 0.],</span>
<span class="go">        [0., 0., 2.]]),</span>
<span class="go">array([[0., 2., 0.],</span>
<span class="go">        [0., 0., 0.],</span>
<span class="go">        [0., 2., 0.]]),</span>
<span class="go">array([[0., 0., 2.],</span>
<span class="go">        [0., 0., 0.],</span>
<span class="go">        [2., 0., 0.]]),</span>
<span class="go">array([[0., 0., 0.],</span>
<span class="go">        [2., 0., 2.],</span>
<span class="go">        [0., 0., 0.]]),</span>
<span class="go">array([[0., 0., 0.],</span>
<span class="go">        [0., 3., 0.],</span>
<span class="go">        [0., 0., 0.]])]</span>
</pre></div>
</div>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="rai_toolbox.augmentations.fourier.FourierBasis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">rai_toolbox.augmentations.fourier.FourierBasis</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="rai_toolbox.augmentations.fourier.create_heatmaps.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">rai_toolbox.augmentations.fourier.create_heatmaps</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022 Massachusetts Institute of Technology.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>